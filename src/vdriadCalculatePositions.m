% update variable names so that it matches syntax of calculateForces
function dust = vdriadCalculatePositions(dust,params,kernel,totalTime);
%UNTITLED6 Summary of this function goes here
%   Detailed explanation goes here
    [dust.d_x,dust.d_y,dust.d_z,...
     dust.d_vx,dust.d_vy,dust.d_vz,...
     dust.d_ax,dust.d_ay,dust.d_az,...
     dust.d_radius,...
     dust.d_mass,...
     dust.d_charge,...
     dust.d_wake_charge,...
     dust.d_wake_length,...
     dust.d_wake_nn_z,...
     dust.d_wake_nn_r,...
     dust.d_wake_nn_id] = feval(kernel, ...
                        dust.d_x,dust.d_y,dust.d_z,...
                        dust.d_vx,dust.d_vy,dust.d_vz,...
                        dust.d_ax,dust.d_ay,dust.d_az,...
                        dust.d_radius,...
                        dust.d_mass,...
                        dust.d_charge,...
                        dust.d_wake_charge,...
                        dust.d_wake_length,...
                        dust.d_wake_nn_z,...
                        dust.d_wake_nn_r,...
                        dust.d_wake_nn_id,...
                        params.DUST_CHARGE_DENSITY_MEAN,...
                        params.ELECTRON_CHARGE,...
                        params.CUTOFF_MULTIPLIER,...
                        params.WAKE_CHARGE_PERCENT,...
                        params.WAKE_LENGTH,...
                        params.ION_DEBYE,...
                        params.ELECTRON_DEBYE,...
                        params.TIME_STEP,...
                        totalTime,...
                        params.NUM_PARTICLES);
end
